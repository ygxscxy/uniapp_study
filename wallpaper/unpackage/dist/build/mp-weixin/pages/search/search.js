"use strict";const e=require("../../common/vendor.js"),a=require("../../service/modules/search.js");if(!Array){(e.resolveComponent("uni-search-bar")+e.resolveComponent("uni-icons")+e.resolveComponent("uv-empty")+e.resolveComponent("uni-load-more"))()}Math||((()=>"../../uni_modules/uni-search-bar/components/uni-search-bar/uni-search-bar.js")+(()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../uni_modules/uv-empty/components/uv-empty/uv-empty.js")+(()=>"../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js"))();const o={__name:"search",setup(o){const u=e.ref({pageNum:1,pageSize:12,keyword:""}),l=e.ref(["搜索词1","搜索词2","搜索词3","搜索词4"]),n=e.ref(["美女","帅哥","宠物","卡通"]),r=e.ref(!1),t=e.ref(!1),s=e.ref([]);e.onLoad((()=>{l.value=e.index.getStorageSync("historySearch")||[]}));const v=()=>{c(),l.value=Array.from(new Set([u.value.keyword,...l.value])),e.index.setStorageSync("historySearch",l.value),i()},i=async()=>{const o=await a.getSearchData({keyword:u.value.keyword,pageNum:u.value.pageNum});s.value=[...s.value,...o.data],e.index.setStorageSync("storageClassifyList",s.value),u.value.pageSize>o.data.length&&(r.value=!0),0==o.data.length&&(t.value=!0),l.value.length>10&&l.value.pop()},c=()=>{s.value=[],u.value={pageNum:1,pageSize:12,keyword:u.value.keyword},r.value=!1,t.value=!1},d=()=>{c()},m=e=>{c(),u.value.keyword=e,l.value=Array.from(new Set([u.value.keyword,...l.value])),i()},p=()=>{e.index.showModal({title:"是否清空历史搜索？",success:a=>{a.confirm&&(e.index.removeStorageSync("historySearch"),l.value=[])}})};return e.onReachBottom((()=>{r.value||(u.value.pageNum++,i())})),e.onUnload((()=>{e.index.removeStorageSync("storageClassifyList")})),(a,o)=>e.e({a:e.o(v),b:e.o(d),c:e.o(d),d:e.o((e=>u.value.keyword=e)),e:e.p({focus:!0,placeholder:"搜索",modelValue:u.value.keyword}),f:!s.value.length||t.value},!s.value.length||t.value?e.e({g:l.value.length},l.value.length?{h:e.p({type:"trash",size:"25"}),i:e.o(p),j:e.f(l.value,((a,o,u)=>({a:e.t(a),b:a,c:e.o((e=>m(a)),a)})))}:{},{k:e.f(n.value,((a,o,u)=>({a:e.t(a),b:a,c:e.o((e=>m(a)),a)})))}):{},{l:0==s.value.length&&1==t.value},0==s.value.length&&1==t.value?{m:e.p({mode:"search",icon:"http://cdn.uviewui.com/uview/empty/search.png"})}:e.e({n:e.f(s.value,((e,a,o)=>({a:e.smallPicurl,b:`/pages/preview/preview?title=${u.value.keyword}&id=${e._id}`,c:e._id}))),o:r.value||s.value.length},r.value||s.value.length?{p:e.p({status:r.value?"noMore":"loading"})}:{}))}},u=e._export_sfc(o,[["__scopeId","data-v-3659915e"]]);wx.createPage(u);
